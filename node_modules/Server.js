var socket = require('socket.io'),
http = require('http'),
server = http.createServer(),
socket = socket.listen(server);
var five = require("johnny-five");  
var SerialPort = require("serialport");
var msgProva = 70;
var board = new five.Board();
var led1;

board.on("ready", function() { 
	led1 = new five.Led(13);

	socket.on('connection', function(connection) {
		console.log('User Connected');
		socket.emit('prova', msgProva);

		connection.on('message', function(msg){
			socket.emit('message', msg);
		});
		
		connection.on('sValue', function(value){
			console.log('sValue', value );
			socket.emit('sValue', value);
		});
		connection.on('slampa', function(value){
			console.log('slampando');
			led1.blink(value);
		});
		connection.on('stopslampa', function(){
			console.log('stop slampando');
			led1.stop();
		});
		
	});
});

server.listen(3000, function(){
    console.log('Server started');
});